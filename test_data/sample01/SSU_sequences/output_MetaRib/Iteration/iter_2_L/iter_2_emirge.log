If you use EMIRGE in your work, please cite these manuscripts, as appropriate.

Miller CS, Baker BJ, Thomas BC, Singer SW, Banfield JF (2011)
EMIRGE: reconstruction of full-length ribosomal genes from microbial community short read sequencing data.
Genome biology 12: R44. doi:10.1186/gb-2011-12-5-r44.

Miller CS, Handley KM, Wrighton KC, Frischkorn KR, Thomas BC, Banfield JF (2013)
Short-Read Assembly of Full-Length 16S Amplicons Reveals Bacterial Diversity in Subsurface Sediments.
PloS one 8: e56018. doi:10.1371/journal.pone.0056018.

imported _emirge C functions from: /home/oschakoo/miniconda3/envs/RiboTaxa_py27/lib/python2.7/site-packages/_emirge_amplicon.so
Command:
/home/oschakoo/miniconda3/envs/RiboTaxa_py27/bin/emirge_amplicon.py emirge_amp/ -1 /home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_1/emirge_amp/iter.20/bbmap.unmaped.1.fq -2 /home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_1/emirge_amp/iter.20/bbmap.unmaped.2.fq --phred33 -l 300 -i 300 -j 1 -s 100 -c 0.3 -a 8 -n 20 -f /home/oschakoo/Documents/Databases/SILVA_p1600_e1900/bowtie_indexed_DB/SILVA_p1600_e1900_clustered_fixed.fasta -b /home/oschakoo/Documents/Databases/SILVA_p1600_e1900/bowtie_indexed_DB/SILVA_p1600_e1900_bowtie_indexed

EMIRGE started at Mon Oct 31 13:42:24 2022
Rewriting reads with indices in headers at Mon Oct 31 13:42:24 2022...
DONE Rewriting reads with indexes in headers at Mon Oct 31 13:42:25 2022 [0:00:00.294641]...
Number of reads (or read pairs) in input file(s): 111690
Preallocating reads and quals in memory at Mon Oct 31 13:42:25 2022...
DONE Preallocating reads and quals in memory at Mon Oct 31 13:42:25 2022 [0:00:00.671963]...
Performing initial mapping with command:
cat  /home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/emirge_tmp_reads_1.fastq |  bowtie --phred33-quals -t -p 8 -n 3 -l 20 -e 300 --best --sam --chunkmbs 128 --minins 300 --maxins 600 /home/oschakoo/Documents/Databases/SILVA_p1600_e1900/bowtie_indexed_DB/SILVA_p1600_e1900_bowtie_indexed -1 - -2 /home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/emirge_tmp_reads_2.fastq | samtools view -S -h -u -b -F 0x0004 - > /home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/initial_mapping/initial_bowtie_mapping.PE.u.bam 
Time loading reference: 00:00:01
Time loading forward index: 00:00:00
Time loading mirror index: 00:00:00
Seeded quality full-index search: 00:00:18
# reads processed: 111690
# reads with at least one reported alignment: 3 (0.00%)
# reads that failed to align: 111687 (100.00%)
Reported 3 paired-end alignments
Time searching: 00:00:19
Overall time: 00:00:19
Beginning initialization at Mon Oct 31 13:42:44 2022...
Reading bam file /home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/initial_mapping/initial_bowtie_mapping.PE.u.bam at Mon Oct 31 13:42:44 2022...
[E::idx_find_and_load] Could not retrieve index file for '/home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/initial_mapping/initial_bowtie_mapping.PE.u.bam'
[E::idx_find_and_load] Could not retrieve index file for '/home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/initial_mapping/initial_bowtie_mapping.PE.u.bam'
[E::idx_find_and_load] Could not retrieve index file for '/home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/initial_mapping/initial_bowtie_mapping.PE.u.bam'
Culled 3 sequences in iteration -1 due to low fraction of reference sequence bases covered by >= 1 reads
DONE Reading bam file /home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/initial_mapping/initial_bowtie_mapping.PE.u.bam at Mon Oct 31 13:42:44 2022 [0:00:00.480174]...
DONE with initialization at Mon Oct 31 13:42:44 2022...
Starting iteration 0 at Mon Oct 31 13:42:44 2022...
Reading bam file /home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/initial_mapping/initial_bowtie_mapping.PE.u.bam at Mon Oct 31 13:42:44 2022...
[E::idx_find_and_load] Could not retrieve index file for '/home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/initial_mapping/initial_bowtie_mapping.PE.u.bam'
[E::idx_find_and_load] Could not retrieve index file for '/home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/initial_mapping/initial_bowtie_mapping.PE.u.bam'
[E::idx_find_and_load] Could not retrieve index file for '/home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/initial_mapping/initial_bowtie_mapping.PE.u.bam'
Culled 3 sequences in iteration 00 due to low fraction of reference sequence bases covered by >= 1 reads
DONE Reading bam file /home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/initial_mapping/initial_bowtie_mapping.PE.u.bam at Mon Oct 31 13:42:45 2022 [0:00:00.440851]...
Calculating likelihood (3, 111690) for iteration 0 at Mon Oct 31 13:42:45 2022...
	Calculating Pr(N=n) for iteration 0 at Mon Oct 31 13:42:45 2022...
	DONE calculating Pr(N=n) for iteration 0 at Mon Oct 31 13:42:45 2022 [0:00:00.000116]...
DONE Calculating likelihood for iteration 0 at Mon Oct 31 13:42:45 2022 [0:00:00.000448]...
Calculating posteriors for iteration 0 at Mon Oct 31 13:42:45 2022...
DONE Calculating posteriors for iteration 0 at Mon Oct 31 13:42:45 2022 [0.000 seconds]...
/home/oschakoo/miniconda3/envs/RiboTaxa_py27/bin/emirge_amplicon.py:508: RuntimeWarning: invalid value encountered in divide
  self.priors[-1] = numpy.asarray(self.posteriors[-1].sum(axis = 1)).flatten() / self.posteriors[-1].sum()
Writing consensus for iteration 0 at Mon Oct 31 13:42:45 2022...
	snp_minor_prob_thresh = 0.100
	snp_percentage_thresh = 0.040
	Split out 0 new minor strain sequences.
	Average time for non-split sequences: [0.000000 seconds]
DONE Writing consensus for iteration 0 at Mon Oct 31 13:42:45 2022 [0:00:00.000592]...
Clustering sequences for iteration 0 at Mon Oct 31 13:42:45 2022...
	cluster threshold = 1.000
Traceback (most recent call last):
  File "/home/oschakoo/miniconda3/envs/RiboTaxa_py27/bin/emirge_amplicon.py", line 1580, in <module>
    main()
  File "/home/oschakoo/miniconda3/envs/RiboTaxa_py27/bin/emirge_amplicon.py", line 1572, in main
    do_iterations(em, max_iter = options.iterations, save_every = None)
  File "/home/oschakoo/miniconda3/envs/RiboTaxa_py27/bin/emirge_amplicon.py", line 1184, in do_iterations
    em.do_iteration(em.current_bam_filename, em.current_reference_fasta_filename)
  File "/home/oschakoo/miniconda3/envs/RiboTaxa_py27/bin/emirge_amplicon.py", line 435, in do_iteration
    self.cluster_sequences(consensus_filename)  # merges sequences that have evolved to be the same (USEARCH)
  File "/home/oschakoo/miniconda3/envs/RiboTaxa_py27/bin/emirge_amplicon.py", line 759, in cluster_sequences
    return self.cluster_sequences_usearch(fastafilename)
  File "/home/oschakoo/miniconda3/envs/RiboTaxa_py27/bin/emirge_amplicon.py", line 789, in cluster_sequences_usearch
    num_seqs = self.write_consensus_with_mask(fastafilename, tmp_fastafilename, mask="soft")
  File "/home/oschakoo/miniconda3/envs/RiboTaxa_py27/bin/emirge_amplicon.py", line 725, in write_consensus_with_mask
    reference_fastafile = pysam.Fastafile(reference_fastafilename)
  File "pysam/libcfaidx.pyx", line 123, in pysam.libcfaidx.FastaFile.__cinit__
  File "pysam/libcfaidx.pyx", line 183, in pysam.libcfaidx.FastaFile._open
IOError: error when opening file `/home/oschakoo/RiboTaxa_test/test_data/sample01/SSU_sequences/output_MetaRib/Iteration/iter_2_L/emirge_amp/iter.00/iter.00.cons.fasta`
